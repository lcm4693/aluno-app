<span #topo tabindex="-10000"></span>

<form [formGroup]="form" class="p-fluid p-3">
  <div class="p-fluid p-3">
    <div class="flex flex-wrap mt-4 mb-4">
      <div class="basis-1/6 md:basis-1/6 pr-3">
        <label>Data da aula:</label>
        <p-calendar
          formControlName="dataAula"
          dateFormat="dd/mm/yy"
          [showIcon]="true"
          [maxDate]="hoje"
          class="w-full"
          [readonlyInput]="modo === 'visualizar'"
        ></p-calendar>
      </div>
    </div>

    <!-- Linha 2: Anotações e demais campos -->
    <div class="flex flex-wrap gap-4">
      <ng-container *ngIf="modo === 'visualizar'; else inputAnotacoes">
        <div class="flex-1 md:w-12">
          <p-panel class="w-full" header="Anotações">
            <div class="white-space-pre-line">
              {{ aula!.anotacoes || "—" }}
            </div>
          </p-panel>
        </div>
      </ng-container>
      <ng-template #inputAnotacoes>
        <div class="flex-1 md:w-12">
          <label for="anotacoes">Anotações:</label>
          <textarea
            pInputTextarea
            formControlName="anotacoes"
            rows="10"
            class="w-full"
            [ngClass]="{
              'ng-invalid ng-dirty':
                form.get('anotacoes')?.invalid && form.get('anotacoes')?.touched
            }"
          ></textarea>
          <small
            class="p-error"
            *ngIf="
              form.get('anotacoes')?.hasError('required') &&
              form.get('anotacoes')?.touched
            "
          >
            O campo Anotações é obrigatório</small
          >
        </div>
      </ng-template>

      <!-- Comentários -->
      <div class="flex-1 md:w-5">
        <ng-container *ngIf="modo === 'visualizar'; else inputComentarios">
          <p-panel class="w-full" header="Comentários do professor">
            <div class="white-space-pre-line">
              {{ aula!.comentarios || "—" }}
            </div>
          </p-panel>
        </ng-container>
        <ng-template #inputComentarios>
          <label>Comentários do professor:</label>
          <textarea
            pInputTextarea
            formControlName="comentarios"
            rows="5"
            class="w-full"
          ></textarea>
        </ng-template>
      </div>

      <div class="flex-1 md:w-5">
        <ng-container *ngIf="modo === 'visualizar'; else inputProxima">
          <p-panel class="w-full" header="Próxima aula">
            <div class="white-space-pre-line">
              {{ form.get("proximaAula")?.value || "—" }}
            </div>
          </p-panel>
        </ng-container>
        <ng-template #inputProxima>
          <label>Próxima aula:</label>
          <textarea
            pInputTextarea
            formControlName="proximaAula"
            rows="5"
            class="w-full"
          ></textarea>
        </ng-template>
      </div>
    </div>

    <!-- Botões -->
    <div
      class="flex justify-content-center gap-4 mt-4"
      *ngIf="modo !== 'visualizar'"
    >
      <!-- <button
        pButton
        type="button"
        label="Salvar"
        icon="pi pi-check"
        class="p-button-primary"
        (click)="submit()"
      ></button>

      <button
        pButton
        type="button"
        label="Cancelar"
        icon="pi pi-times"
        class="p-button-secondary"
        (click)="fechar()"
      ></button> -->

      <p-button
        label="Salvar"
        icon="pi pi-check"
        class="p-button-primary"
        (onClick)="submit()"
      ></p-button>
      <p-button
        label="Cancelar"
        icon="pi pi-times"
        [raised]="true"
        severity="secondary"
        (onClick)="fechar()"
      ></p-button>
    </div>
    <div
      class="flex justify-content-center gap-4 mt-4"
      *ngIf="modo === 'visualizar'"
    >
      <p-button
        label="Editar"
        icon="pi pi-pencil"
        severity="primary"
        (onClick)="modo = 'editar'"
      ></p-button>
      <p-button
        label="Fechar"
        icon="pi pi-times"
        [raised]="true"
        severity="secondary"
        (onClick)="fechar()"
      ></p-button>
    </div>
  </div>
</form>
